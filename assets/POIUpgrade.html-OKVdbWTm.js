import{_ as t}from"./plugin-vue_export-helper-x3n3nnut.js";import{r as p,o as e,c,d as o,a as n,f as l,w as i,b as s,e as u}from"./app-xS5i7JKJ.js";const k={},r=n("p",null,[n("code",null,"more"),s(" POI单元格格式设置，数据筛选")],-1),d=n("p",null,"这篇文章是对POI基础运用的技术补充",-1),m=u(`<h3 id="设置单元格的对其方式" tabindex="-1"><a class="header-anchor" href="#设置单元格的对其方式" aria-hidden="true">#</a> 设置单元格的对其方式</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">Workbook</span> wb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XSSFWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//or new HSSFWorkbook();</span>
    <span class="token class-name">Sheet</span> sheet <span class="token operator">=</span> wb<span class="token punctuation">.</span><span class="token function">createSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Row</span> row <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">createRow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    row<span class="token punctuation">.</span><span class="token function">setHeightInPoints</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">createCell</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">,</span> <span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span><span class="token constant">BOTTOM</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">createCell</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> row<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">CENTER_SELECTION</span><span class="token punctuation">,</span> <span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span><span class="token constant">BOTTOM</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">createCell</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> row<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">FILL</span><span class="token punctuation">,</span> <span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">createCell</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> row<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">GENERAL</span><span class="token punctuation">,</span> <span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">createCell</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> row<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">JUSTIFY</span><span class="token punctuation">,</span> <span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span><span class="token constant">JUSTIFY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">createCell</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> row<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">LEFT</span><span class="token punctuation">,</span> <span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span><span class="token constant">TOP</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">createCell</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> row<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token class-name">HorizontalAlignment</span><span class="token punctuation">.</span><span class="token constant">RIGHT</span><span class="token punctuation">,</span> <span class="token class-name">VerticalAlignment</span><span class="token punctuation">.</span><span class="token constant">TOP</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Write the output to a file</span>
    <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">OutputStream</span> fileOut <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">&quot;xssf-align.xlsx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        wb<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fileOut<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    wb<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">createCell</span><span class="token punctuation">(</span><span class="token class-name">Workbook</span> wb<span class="token punctuation">,</span> <span class="token class-name">Row</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> column<span class="token punctuation">,</span> <span class="token class-name">HorizontalAlignment</span> halign<span class="token punctuation">,</span> <span class="token class-name">VerticalAlignment</span> valign<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Cell</span> cell <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string">&quot;Align It&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">CellStyle</span> cellStyle <span class="token operator">=</span> wb<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cellStyle<span class="token punctuation">.</span><span class="token function">setAlignment</span><span class="token punctuation">(</span>halign<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cellStyle<span class="token punctuation">.</span><span class="token function">setVerticalAlignment</span><span class="token punctuation">(</span>valign<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cell<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="遍历所有行和单元格" tabindex="-1"><a class="header-anchor" href="#遍历所有行和单元格" aria-hidden="true">#</a> 遍历所有行和单元格</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Sheet</span> sheet <span class="token operator">:</span> wb <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Row</span> row <span class="token operator">:</span> sheet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Cell</span> cell <span class="token operator">:</span> row<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Do something here</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="设置单元格日期类型" tabindex="-1"><a class="header-anchor" href="#设置单元格日期类型" aria-hidden="true">#</a> 设置单元格日期类型</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//row.createCell(8).setCellValue(devices.get(i-1).getBirthDate());</span>
<span class="token class-name">XSSFCell</span> cell <span class="token operator">=</span> row<span class="token punctuation">.</span><span class="token function">createCell</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建了一个单元格类型的对象，其给他使用了日期的格式为m/d/yy</span>
<span class="token class-name">XSSFCellStyle</span> cellStyle <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">createCellStyle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">CreationHelper</span> createHelper <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">getCreationHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建了一个日期格式的帮助器，并将其应用到\`cellStyle\`中。</span>
                cellStyle<span class="token punctuation">.</span><span class="token function">setDataFormat</span><span class="token punctuation">(</span>createHelper<span class="token punctuation">.</span><span class="token function">createDataFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFormat</span><span class="token punctuation">(</span><span class="token string">&quot;m/d/yy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 将对应的cell，应用创建好的格式</span>
cell<span class="token punctuation">.</span><span class="token function">setCellStyle</span><span class="token punctuation">(</span>cellStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置单元格值</span>
cell<span class="token punctuation">.</span><span class="token function">setCellValue</span><span class="token punctuation">(</span>devices<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBirthDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="设置单元格的数据限制" tabindex="-1"><a class="header-anchor" href="#设置单元格的数据限制" aria-hidden="true">#</a> 设置单元格的数据限制</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">/*
     * sheet：工作簿
     * rules：规定的字符串
     * row：生成的列数
     * */</span>
<span class="token keyword">public</span> <span class="token class-name">DataValidation</span> <span class="token class-name">ValidationData</span><span class="token punctuation">(</span><span class="token class-name">XSSFSheet</span> sheet<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> rules <span class="token punctuation">,</span> <span class="token class-name">Integer</span> row<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">DataValidationHelper</span> validationHelper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XSSFDataValidationHelper</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">XSSFSheet</span><span class="token punctuation">)</span> sheet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DataValidationConstraint</span> constraint <span class="token operator">=</span> validationHelper<span class="token punctuation">.</span><span class="token function">createExplicitListConstraint</span><span class="token punctuation">(</span>rules<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置数据有效性约束的起始终止位置</span>
        <span class="token comment">// 第2行第1列到第601行第1列</span>
        <span class="token class-name">CellRangeAddressList</span> addressList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CellRangeAddressList</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> row<span class="token punctuation">,</span> row<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DataValidation</span> dataValidation <span class="token operator">=</span> validationHelper<span class="token punctuation">.</span><span class="token function">createValidation</span><span class="token punctuation">(</span>constraint<span class="token punctuation">,</span> addressList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dataValidation<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8);function v(b,w){const a=p("RouterLink");return e(),c("div",null,[r,o(" more "),d,n("p",null,[l(a,{to:"/blog/POI.html"},{default:i(()=>[s("POI的基础入门入口")]),_:1})]),m])}const f=t(k,[["render",v],["__file","POIUpgrade.html.vue"]]);export{f as default};
